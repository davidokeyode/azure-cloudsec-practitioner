
## Enumerate Entra ID Tenant Information anonymously
* We will use the **`GetEntraIDInfo`** for this scenario. This PowerShell script fetches and displays information about an Entra ID tenant based on a provided email address. It can determine whether the organization is using Entra ID, if federation is configured and provides relevant details such as the Tenant ID, Tenant Region, User State, and Federation Auth URL. This is useful for anonymous recon in an Azure Pentest scenario.
* In a penetration test scenario, the tester could use this information to:
  * Enumerate valid users in a tenant.
  * Craft more convincing phishing emails that could trick users into entering their credentials on a fake login page.
  * Identify the tenant ID which will be needed to enumerate resources in the tenant if a credential is compromised later on.

1. **Open a PowerShell terminal on your Pentest VM and download the script using the commands below:**
```
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/davidokeyode/azure-cloudsec-practitioner/main/GetEntraIDInfo/GetEntraIDInfo.ps1" -OutFile "GetEntraIDInfo.ps1"

Unblock-File -Path .\GetEntraIDInfo.ps1

Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser -Force
```

2. **Execute the script, providing the email as an argument:**:
* Replace **`example@domain.onmicrosoft.com`** with your student email (In the LabXX-Info file) or any other username you want to query.
* You might even try your corporate email to see what it returns.
```
.\GetEntraIDInfo.ps1 -Email "example@domain.onmicrosoft.com"
```

4. **Output Details**
* The script provides the following output details:
   * **Entra ID Discovery**: This indicates whether the domain exists in Entra ID.
   * **Entra ID Configuration**: This provides information on how Entra ID is implemented for the domain.
   * **Entra Tenant ID**: Displays the Entra ID Tenant ID if Entra ID is in use.
   * **Entra Tenant Region**: Indicates the region of the Entra ID tenant.
   * **User State**: Provides the state of the user in the Entra ID tenant.
   * **Federation**: Indicates if Federation is configured or not.
   * **Federation Auth URL**: If Federation is configured, this URL provides the authentication endpoint for the federation service.


## Alternative
* You can also use the AADInternals tool to get similar information:
   * https://aadinternals.com/aadinternals/ 
```
## Install the module from the PowerShell Gallery
Install-Module AADInternals

## Import AADInternals module
Import-Module AADInternals

## Get Entra ID information
Get-AADIntLoginInformation -Username "example@domain.onmicrosoft.com"
```
