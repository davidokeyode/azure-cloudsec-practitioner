$group = "platform-resource-enum-rg"
$customappname = "customapp"
$containerappname = "containerapp"

# Delete the resource group, which will also delete all resources within it
az group delete --name $group --yes --no-wait

# Remove service principals
$customappID = (az ad sp list --display-name $customappname --query "[].appId" --output tsv)
$containerappID = (az ad sp list --display-name $containerappname --query "[].appId" --output tsv)

az ad sp delete --id $customappID
az ad sp delete --id $containerappID

# Cleanup role assignments for the service principals
az role assignment delete --assignee $customappID --role Reader
az role assignment delete --assignee $containerappID --role Reader

Write-Output "Cleanup completed!"
