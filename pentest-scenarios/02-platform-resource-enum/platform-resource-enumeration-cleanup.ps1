$group = "platform-resource-enum-rg"
$customappname = "customapp"
$containerappname = "containerapp"

# Delete the resource group, which will also delete all resources within it
az group delete --name $group --yes --no-wait

# Get service principals IDs
$customappID = (az ad app list --display-name $customappname --query "[].appId" --output tsv)
$containerappID = (az ad app list --display-name $containerappname --query "[].appId" --output tsv)

# Cleanup role assignments for the service principals
az role assignment delete --assignee $customappID --role Reader
az role assignment delete --assignee $containerappID --role Reader

# Cleanup the service principals
az ad app delete --id $customappID
az ad app delete --id $containerappID

Write-Output "Cleanup completed!"
